# 📘邏輯回歸（Logistic Regression）

---

## 1️⃣ 模型核心概念

邏輯回歸是一種機率型的分類模型，它的目標是預測某一個樣本屬於某個類別的機率

儘管名字裡有「回歸」，但它實際上是用來做分類任務，特別是：

- 二元分類（如：是否為某疾病）

- 或延伸成多元分類（如：Iris 分類中的三種花）

## 2️⃣ 數學基礎

邏輯回歸的本質是使用一條「線性函數」來預測資料點的結果，但會透過一個Sigmoid 函數來將這個線性預測值轉換成機率：

👉 預測公式：

```python
z = w₁x₁ + w₂x₂ + ... + wₙxₙ + b
```

這裡的 z 是線性組合（和線性回歸一樣），w 是每個特徵的權重，x 是特徵數值，b 是偏差項

👉 Sigmoid 函數轉換：

```python
P(y=1|x) = 1 / (1 + e^(-z))
```

這個公式會把 z 的值壓縮到 0 到 1 之間，代表某類別的機率

👉 分類決策：

- 若機率 > 0.5，預測為類別 1

- 若機率 < 0.5，預測為類別 0

- 多類別情況下會使用 softmax 函數（邏輯回歸的延伸版本）來分配每個類別的機率

## 3️⃣ 模型訓練方式

邏輯回歸的目標是找到一組參數（權重）w 和 b，讓模型對訓練資料的預測越準越好

- 透過最大化**對數似然函數（Log Likelihood）**來進行參數學習

- 最常見的優化方法是使用梯度下降法（Gradient Descent）

---

## ✅ 優點（Advantages）

1. 簡單直觀，易於實作與解釋
> 每個特徵對結果的貢獻可以用權重來說明，是一種「可解釋性高」的模型

2. 計算效率高
> 適合中小型資料集，可以快速訓練與預測

3. 可輸出機率
> 相對於只給出分類結果，邏輯回歸可以告訴你「預測為某類的機率」

4. 不需要太多參數調整
> 相對於複雜模型，邏輯回歸的超參數較少，容易訓練與調整

5. 適用於線性可分的資料
> 如果不同類別的資料點之間可以用一條直線（或超平面）區分，效果會非常好

## ❌ 缺點（Disadvantages）

1. 只能擬合線性邊界
> 若資料之間是非線性分界（例如彎曲形狀），邏輯回歸可能表現很差

2. 對於離群值敏感
> 極端數值可能會大幅影響模型的預測

3. 需進行特徵縮放與轉換
> 如果特徵尺度差異太大，模型會較難學習正確的權重，需搭配標準化

4. 對特徵間共線性敏感
> 若某些特徵彼此高度相關，會影響模型穩定性與解釋性

5. 效能限制
> 在高維度或複雜資料（如影像、語音）中表現不佳，容易被更複雜的模型（如決策樹、SVM、深度學習）取代

---

## 🌱 舉例：預測「是否會考上大學」

### 🎯 問題設定：

我們想要根據一個學生的模擬考分數（0～100 分），來預測他是否會考上大學（是/否，對應 1 或 0）：

| 分數 (X) | 是否考上大學 (Y) |
| ------ | ---------- |
| 30     | 0          |
| 40     | 0          |
| 50     | 0          |
| 60     | 1          |
| 70     | 1          |
| 80     | 1          |

### 🧠 模型想做什麼？

我們想要找一條「機率曲線」來預測：分數越高，考上的機率越大

邏輯回歸會做兩件事：

#### 1️⃣ 建立一個線性模型

> z = w × X + b  
這就像你用分數來預測某個數值

#### 2️⃣ 套用 Sigmoid 函數，把 z 轉成機率

> P(Y=1 | X) = 1 / (1 + e^(-z))  
這樣輸出會是 0～1 之間的值，代表「考上的機率」

### ✨ 預測例子

假設模型學出來的參數是：

- w = 0.2

- b = -10

我們來算 60 分的學生：

> z = 0.2 × 60 - 10 = 2  
P = 1 / (1 + e^(-2)) ≈ 0.88

表示：60 分的學生，有 88% 機會考上

### 🧾 分類決策

邏輯回歸會根據機率決定類別（通常用門檻 0.5）：

- 如果機率 > 0.5 → 預測為 會考上（Y=1）

- 如果機率 < 0.5 → 預測為 不會考上（Y=0）

### 🖼 圖像直覺

如果你畫出所有點和模型預測的機率曲線，你會看到一條 S 形曲線：

- 左邊低分 → 機率接近 0

- 右邊高分 → 機率接近 1

- 中間區域 → 過渡區（50%左右）

### ✅ 小結

- 輸入是數值（如分數）

- 輸出是機率（屬於哪類的可能性）

- 再用機率決定分類（例如超過 0.5 就判斷為「會考上」）